<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui" />
    
      <title data-ream-head="true">VUX</title>
      
      
      
      
    <link rel="preload" href="/manifest.d8c72eb1.js" as="script"><link rel="preload" href="/vendor.08c64339.js" as="script"><link rel="preload" href="/client.60b9b90f.js" as="script"><link rel="preload" href="/client.4dc9d36a.css" as="style"><link rel="preload" href="/20.44cab544.js" as="script"><link rel="prefetch" href="/0.6cb0af63.js" as="script"><link rel="prefetch" href="/2.b48e91f5.js" as="script"><link rel="prefetch" href="/3.7cb47d26.js" as="script"><link rel="prefetch" href="/4.85e12d27.js" as="script"><link rel="prefetch" href="/5.56b14bac.js" as="script"><link rel="prefetch" href="/6.e12301dd.js" as="script"><link rel="prefetch" href="/7.f54651e4.js" as="script"><link rel="prefetch" href="/8.68e1df81.js" as="script"><link rel="prefetch" href="/9.5eccf876.js" as="script"><link rel="prefetch" href="/10.d63050d1.js" as="script"><link rel="prefetch" href="/11.bad89dfd.js" as="script"><link rel="prefetch" href="/12.5cafb971.js" as="script"><link rel="prefetch" href="/13.6a5775a5.js" as="script"><link rel="prefetch" href="/14.0199a017.js" as="script"><link rel="prefetch" href="/15.f71862b5.js" as="script"><link rel="prefetch" href="/16.3dc07163.js" as="script"><link rel="prefetch" href="/17.871a6686.js" as="script"><link rel="prefetch" href="/18.c7c493f3.js" as="script"><link rel="prefetch" href="/19.72c28a13.js" as="script"><link rel="prefetch" href="/21.794601c1.js" as="script"><link rel="prefetch" href="/22.be706834.js" as="script"><link rel="prefetch" href="/23.d98a992b.js" as="script"><link rel="prefetch" href="/24.37be98f1.js" as="script"><link rel="prefetch" href="/25.1bc0eca0.js" as="script"><link rel="prefetch" href="/26.180a0cfd.js" as="script"><link rel="prefetch" href="/27.dbb541bf.js" as="script"><link rel="prefetch" href="/28.6b226973.js" as="script"><link rel="prefetch" href="/29.112ab65c.js" as="script"><link rel="prefetch" href="/30.c632ef45.js" as="script"><link rel="prefetch" href="/31.57094a21.js" as="script"><link rel="prefetch" href="/32.d9decc0e.js" as="script"><link rel="prefetch" href="/33.3640b38d.js" as="script"><link rel="prefetch" href="/34.9ff6ce72.js" as="script"><link rel="prefetch" href="/35.ab0e508a.js" as="script"><link rel="prefetch" href="/36.62ae7e36.js" as="script"><link rel="prefetch" href="/37.06a924a7.js" as="script"><link rel="prefetch" href="/38.f87f28d4.js" as="script"><link rel="prefetch" href="/39.6e381a36.js" as="script"><link rel="prefetch" href="/40.e068d3f0.js" as="script"><link rel="prefetch" href="/41.455d941f.js" as="script"><link rel="prefetch" href="/42.64b3a03b.js" as="script"><link rel="prefetch" href="/43.b720d16f.js" as="script"><link rel="prefetch" href="/44.763c0977.js" as="script"><link rel="prefetch" href="/45.4a4fada3.js" as="script"><link rel="prefetch" href="/46.9db49ccb.js" as="script"><link rel="prefetch" href="/47.00d1f7eb.js" as="script"><link rel="prefetch" href="/48.fe206e88.js" as="script"><link rel="prefetch" href="/49.cb216ff5.js" as="script"><link rel="prefetch" href="/50.69109b11.js" as="script"><link rel="prefetch" href="/51.33b002da.js" as="script"><link rel="prefetch" href="/52.771901cf.js" as="script"><link rel="prefetch" href="/53.898a33bb.js" as="script"><link rel="prefetch" href="/54.deb33774.js" as="script"><link rel="prefetch" href="/55.837071af.js" as="script"><link rel="prefetch" href="/56.60315483.js" as="script"><link rel="prefetch" href="/57.bd77e60f.js" as="script"><link rel="prefetch" href="/58.59c892c0.js" as="script"><link rel="prefetch" href="/59.59128fd4.js" as="script"><link rel="prefetch" href="/60.96b9addd.js" as="script"><link rel="prefetch" href="/61.4bcc38ca.js" as="script"><link rel="prefetch" href="/62.e58c7861.js" as="script"><link rel="prefetch" href="/63.37f2dc4a.js" as="script"><link rel="prefetch" href="/64.4f7b5c7b.js" as="script"><link rel="prefetch" href="/65.ef4ea6d1.js" as="script"><link rel="prefetch" href="/66.dbba6d87.js" as="script"><link rel="prefetch" href="/67.fb00dbcb.js" as="script"><link rel="prefetch" href="/68.78bba927.js" as="script"><link rel="prefetch" href="/69.65a4094d.js" as="script"><link rel="prefetch" href="/70.11765008.js" as="script"><link rel="prefetch" href="/71.2ef0f07b.js" as="script"><link rel="prefetch" href="/72.66e7f223.js" as="script"><link rel="prefetch" href="/73.763dd6a8.js" as="script"><link rel="prefetch" href="/74.0443e7be.js" as="script"><link rel="prefetch" href="/75.0a62935e.js" as="script"><link rel="prefetch" href="/76.cd7bc9a0.js" as="script"><link rel="prefetch" href="/77.3ced356d.js" as="script"><link rel="prefetch" href="/78.73c30cad.js" as="script"><link rel="prefetch" href="/79.e5f6d42e.js" as="script"><link rel="prefetch" href="/80.6a1a432c.js" as="script"><link rel="prefetch" href="/81.a38bca47.js" as="script"><link rel="prefetch" href="/82.d0a9ea7c.js" as="script"><link rel="prefetch" href="/83.b5a60bea.js" as="script"><link rel="prefetch" href="/84.10e42f4c.js" as="script"><link rel="prefetch" href="/85.cf66f46c.js" as="script"><link rel="prefetch" href="/86.e8f0382a.js" as="script"><link rel="prefetch" href="/87.50bfd153.js" as="script"><link rel="prefetch" href="/88.3e08902c.js" as="script"><link rel="prefetch" href="/89.90ccabc9.js" as="script"><link rel="prefetch" href="/90.bd40a6fe.js" as="script"><link rel="prefetch" href="/91.1c612a94.js" as="script"><link rel="prefetch" href="/92.92be7e97.js" as="script"><link rel="prefetch" href="/93.43694fec.js" as="script"><link rel="prefetch" href="/94.cf8196cd.js" as="script"><link rel="prefetch" href="/95.cf47fd63.js" as="script"><link rel="prefetch" href="/96.116077d8.js" as="script"><link rel="prefetch" href="/97.99d09993.js" as="script"><link rel="prefetch" href="/98.d2a9e5e4.js" as="script"><link rel="prefetch" href="/99.9cb073cf.js" as="script"><link rel="prefetch" href="/100.09ffaaac.js" as="script"><link rel="prefetch" href="/101.5fcd4571.js" as="script"><link rel="prefetch" href="/102.1476e6e3.js" as="script"><link rel="prefetch" href="/103.3a6ff8e2.js" as="script"><link rel="prefetch" href="/104.98c03071.js" as="script"><link rel="prefetch" href="/105.b8665899.js" as="script"><link rel="prefetch" href="/106.ec2a4311.js" as="script"><link rel="prefetch" href="/107.a78071ab.js" as="script"><link rel="prefetch" href="/108.bd4270e7.js" as="script"><link rel="prefetch" href="/109.e06e70c2.js" as="script"><link rel="prefetch" href="/110.3bb48108.js" as="script"><link rel="prefetch" href="/111.1521369c.js" as="script"><link rel="prefetch" href="/112.b2e8ace8.js" as="script"><link rel="prefetch" href="/113.40cfb807.js" as="script"><link rel="prefetch" href="/114.ad9e3d6b.js" as="script"><link rel="prefetch" href="/115.27976e0a.js" as="script"><link rel="prefetch" href="/116.3acdb645.js" as="script"><link rel="prefetch" href="/117.ceeb6e76.js" as="script"><link rel="prefetch" href="/118.f70b957c.js" as="script"><link rel="prefetch" href="/119.7b2c8663.js" as="script"><link rel="prefetch" href="/120.89e5f6b5.js" as="script"><link rel="prefetch" href="/121.e0a9c4f4.js" as="script"><link rel="prefetch" href="/122.adb41671.js" as="script"><link rel="prefetch" href="/123.037eff51.js" as="script"><link rel="prefetch" href="/124.c0cf46ef.js" as="script"><link rel="prefetch" href="/125.528bf809.js" as="script"><link rel="prefetch" href="/126.47fd7d1d.js" as="script"><link rel="prefetch" href="/127.493a8fb7.js" as="script"><link rel="prefetch" href="/128.2c439557.js" as="script"><link rel="prefetch" href="/129.a0bf9de2.js" as="script"><link rel="prefetch" href="/130.92a18775.js" as="script"><link rel="prefetch" href="/131.8ce2e67e.js" as="script"><link rel="prefetch" href="/132.60b279d3.js" as="script"><link rel="prefetch" href="/133.0115ce84.js" as="script"><link rel="prefetch" href="/134.f8bd98d0.js" as="script"><link rel="prefetch" href="/135.7a3b5537.js" as="script"><link rel="prefetch" href="/136.1a93220a.js" as="script"><link rel="prefetch" href="/137.5d003de6.js" as="script"><link rel="prefetch" href="/138.67efcc85.js" as="script"><link rel="prefetch" href="/139.fd43dbee.js" as="script"><link rel="prefetch" href="/140.bb772dc3.js" as="script"><link rel="prefetch" href="/141.e31453ea.js" as="script"><link rel="prefetch" href="/142.7bcf50fb.js" as="script"><link rel="prefetch" href="/143.9d78cf2e.js" as="script"><link rel="prefetch" href="/144.006dc296.js" as="script"><link rel="prefetch" href="/145.db02189b.js" as="script"><link rel="prefetch" href="/146.f62a804b.js" as="script"><link rel="prefetch" href="/147.f59448e8.js" as="script"><link rel="prefetch" href="/148.2f70e263.js" as="script"><link rel="prefetch" href="/149.f38c5778.js" as="script"><link rel="prefetch" href="/150.2083c569.js" as="script"><link rel="prefetch" href="/151.44e532c1.js" as="script"><link rel="prefetch" href="/152.d56ca49d.js" as="script"><link rel="prefetch" href="/153.69e6e127.js" as="script"><link rel="prefetch" href="/154.a407c8e1.js" as="script"><link rel="prefetch" href="/155.ed4584c1.js" as="script"><link rel="prefetch" href="/156.315a5965.js" as="script"><link rel="prefetch" href="/157.6855361d.js" as="script"><link rel="prefetch" href="/158.f01a3cae.js" as="script"><link rel="prefetch" href="/159.7510d862.js" as="script"><link rel="prefetch" href="/160.53657daf.js" as="script"><link rel="prefetch" href="/161.e6022efd.js" as="script"><link rel="prefetch" href="/162.f79378c7.js" as="script"><link rel="prefetch" href="/163.9c7d25fe.js" as="script"><link rel="prefetch" href="/1.5ba6cc82.js" as="script">
    <link rel="stylesheet" href="/client.4dc9d36a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="app" class="app"><div class="vux-box" style="height:1000px;"><div class="sidebar-inner" style="height:1000px;"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="1024px" height="1024px" viewBox="0 0 1024 1024" enable-background="new 0 0 1024 1024" xml:space="preserve" style="width:60px;height:60px;"><path data-index="path_0" fill="#35495e" d="M512 816.64 51.2 985.6l460.8-947.2 460.8 947.2L512 816.64 512 816.64zM509.44 207.36 189.44 862.72l317.44-117.76L506.88 207.36 509.44 207.36zM509.44 207.36" class="svgpath"></path></svg><br><span class="vux-version">2.x</span><h1 class="vux-title">VUX</h1><div class="vux-center vux-sub-title">Proudly Powered by
    <br>
    WeUI + Vue + Webpack</div><div><br><a target="_blank" href="https://github.com/airyland/vux" class="vux-github"><svg viewBox="0 0 64 64" width="48" height="48"><path stroke-width="0" fill="currentColor" d="M32 0 C14 0 0 14 0 32 0 53 19 62 22 62 24 62 24 61 24 60 L24 55 C17 57 14 53 13 50 13 50 13 49 11 47 10 46 6 44 10 44 13 44 15 48 15 48 18 52 22 51 24 50 24 48 26 46 26 46 18 45 12 42 12 31 12 27 13 24 15 22 15 22 13 18 15 13 15 13 20 13 24 17 27 15 37 15 40 17 44 13 49 13 49 13 51 20 49 22 49 22 51 24 52 27 52 31 52 42 45 45 38 46 39 47 40 49 40 52 L40 60 C40 61 40 62 42 62 45 62 64 53 64 32 64 14 50 0 32 0 Z"></path></svg><br><img src="https://img.shields.io/github/stars/airyland/vux.svg?style=social&amp;label=Star" alt="" class="github-star"></a><p class="vux-center vux-sub-title vux-time-ago">Since <span>443</span> Days Ago</p><br><p><a href="https://wj.qq.com/s/1170299/9518/" target="_blank" class="survey"> VUX 开发者调查 &gt;&gt;</a></p></div><div class="livingearth-logo"><p class="product-title">Ad: Our Product</p><a href="#/zh-CN/livingearth?x-block=sidebar"><img src="https://oixyh3u6e.qnssl.com/livingearth/livingearth.png" width="140px" alt=""></a></div></div></div><div class="summary"><div class="summary-inner" style="left:190px;height:1000px;"><div class="chapter"><p class="chapter-title">入坑指南</p><ul class="chapter-page"><li class="chapter-page-item"><a href="/zh-CN/" class="router-link-active">关于 VUX</a></li><li class="chapter-page-item"><a href="/zh-CN/about/before-using-vux.html">使用 VUX 之前</a></li><li class="chapter-page-item"><a href="/zh-CN/faq/">常见问题</a></li><li class="chapter-page-item"><a href="/zh-CN/about/showcase.html">使用案例</a></li></ul></div><div class="chapter"><p class="chapter-title">安装使用</p><ul class="chapter-page"><li class="chapter-page-item"><a href="/zh-CN/install/npm.html">安装</a></li><li class="chapter-page-item"><a href="/zh-CN/install/biolerplate.html">快速开始</a></li><li class="chapter-page-item"><a href="/zh-CN/install/manual-usage.html">手动安装配置</a></li><li class="chapter-page-item"><a href="/zh-CN/install/usage.html">代码示例</a></li></ul></div><div class="chapter"><p class="chapter-title">定制</p><ul class="chapter-page"><li class="chapter-page-item"><a href="/zh-CN/development/i18n.html">国际化</a></li><li class="chapter-page-item"><a href="/zh-CN/development/theme.html">主题</a></li></ul></div><div class="chapter"><p class="chapter-title">开发</p><ul class="chapter-page"><li class="chapter-page-item"><a href="/zh-CN/development/router.html">路由</a></li><li class="chapter-page-item"><a href="/zh-CN/development/vue-ajax.html">Ajax 请求</a></li><li class="chapter-page-item"><a href="/zh-CN/development/remove-click-delay-fastclick.html">点击延迟</a></li><li class="chapter-page-item"><a href="/zh-CN/wechat/vue-wechat-jssdk.html">使用微信 jssdk</a></li></ul></div><div class="chapter"><p class="chapter-title">贡献</p><ul class="chapter-page"><li class="chapter-page-item"><a href="/zh-CN/contribution/issue.html">提交 issue</a></li><li class="chapter-page-item"><a href="/zh-CN/contribution/pr.html">提交 pr</a></li><li class="chapter-page-item"><a href="/zh-CN/contribution/vux-development.html">本地开发</a></li></ul></div></div></div><div class="content"><div class="markdown-body"><div><h2 class="big-title">vux!vue</h2> <p align="left"><a href="https://www.npmjs.com/package/vux-loader"><img src="https://img.shields.io/npm/v/vux-loader.svg?style=flat-square" alt=""></a> <a href="https://www.npmjs.com/package/vux-loader"><img src="https://img.shields.io/npm/dm/vux-loader.svg?style=flat-square" alt=""></a></p> <h3>介绍</h3> <p><code>vux-loader</code>工具的作用是对<code>.vue</code>代码进行预处理，不限于 vux 组件库。</p> <p>它是针对<code>webpack+vue-loader</code>项目的工程化工具，简化了webpack插件和loader的使用和编写，支持在vue-loader处理之前进行预处理，同时内置对vux组件专用的配置和优化插件。</p> <p>当然除了.vue文件外，你还可以对js文件进行预处理。说好的处理.vue文件，为什么连<code>js</code>文件也不放过呢？因为只有处理js才能实现理想工程化。举个例子，如果用户需要在<code>main.js</code>中调用vux的plugin，他需要这样做：</p> <pre class="hljs"><code><span class="hljs-keyword">import</span> AlertPlugin <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vux/src/plugins/Alert&#x27;</span>
<span class="hljs-keyword">import</span> ToastPlugin <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vux/src/plugins/Toast&#x27;</span>
</code></pre> <p>虽然路径不长，但是看着相当不和谐，为了简化这个操作vux提供了更简洁的写法：</p> <pre class="hljs"><code><span class="hljs-keyword">import</span> { AlertPlugin, ToastPlugin } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vux&#x27;</span>
</code></pre> <p>这个操作即是通过<code>js-parser</code>插件解析main.js里的<code>import</code>语法来实现的，最终进入babel的代码和上面单独引入一致。</p> <p>这个工具也许会帮你进一步打开<code>Vue</code>项目工程化的思路。</p> <p class="tip">
  作为通用工具，即使你没有使用Vux，依然可以使用它来进行各种代码处理。
  <br>
  目前支持 vue-loader@&gt;9.x, 低版本没有具体测试。
  <br>
  &#x60;vux!vue&#x60;的loader写法只兼容webpack@1.x，为了兼容webpack@2.x，处理后的loader配置是&#x60;vux-loader!vue-loader&#x60;
</p> <h3>实现方式</h3> <p>说明一下<code>vux-loader</code>是如何和<code>vue-loader</code><del>搞基</del>配合的，vue-loader的issue里不少同学遇到预处理.vue的问题。</p> <p>如果你看过<code>webpack</code>loader的介绍，理论上说如果需要自己手动先处理代码再传入<code>vue-loader</code>,你只需要这样对loader做配置: <code>vue-loader!my-loader</code>。但是如果你试过，就知道这个目前行不通。<code>vue-loader</code>不会接收上一个loader的source进行处理，因为.vue文件的特殊性，它直接生成了loader string进入下一个处理，处理后的结果大概是这样的：</p> <pre class="hljs"><code><span class="hljs-comment">/* styles */</span>
<span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;!!vue-style-loader!css-loader!vue-loader/lib/style-rewriter?id=data-v-20d7ba9a!vue-loader/lib/selector?type=styles&amp;index=0!./index.vue&quot;</span>)

<span class="hljs-comment">/* script */</span>
__vue_exports__ = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;!!babel-loader!vue-loader/lib/selector?type=script&amp;index=0!./index.vue&quot;</span>)

<span class="hljs-comment">/* template */</span>
<span class="hljs-keyword">var</span> __vue_template__ = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;!!vue-loader/lib/template-compiler?id=data-v-20d7ba9a!vue-loader/lib/selector?type=template&amp;index=0!./index.vue&quot;</span>)
</code></pre> <p>那么vue-loader提供了自定义loader string的选项，直接配置可否呢，<a href="https://github.com/vuejs/vue-loader/issues/531">#531</a>，直接配置会破坏原来的loader参数，导致不能Live reload。</p> <p>那么最终能想到的就是直接修改<code>vue-loader</code>生成的代码，这样既不会影响<code>vue-loader</code>原来的逻辑，也能自由控制。</p> <p>最终实现方式是前置<code>vux-loader</code>即：<code>vux-loader!vue-loader</code>，vux-loader将vue-loader生成的代码二次处理，分割loader string并(强行)插入vux的 template-loader, style-loader, script-loader，那么你就能理解vux-loader的配置方式了，在3大基本loader里获取到vux-loader的插件配置列表逐个做处理就行了。</p> <p>上面的代码强行处理后是这样的：</p> <pre class="hljs"><code><span class="hljs-comment">/* styles */</span>
<span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;!!vue-style-loader!css-loader!vue-loader/lib/style-rewriter?id=data-v-20d7ba9a!./../../../../vux-loader/src/style-loader.js!vue-loader/lib/selector?type=styles&amp;index=0!./index.vue&quot;</span>)

<span class="hljs-comment">/* script */</span>
__vue_exports__ = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;!!babel-loader!vue-loader/lib/selector?type=script&amp;index=0!./../../../../vux-loader/src/script-loader.js!./index.vue&quot;</span>)

<span class="hljs-comment">/* template */</span>
<span class="hljs-keyword">var</span> __vue_template__ = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;!!vue-loader/lib/template-compiler?id=data-v-20d7ba9a!./../../../../vux-loader/src/template-loader.js!vue-loader/lib/selector?type=template&amp;index=0!./index.vue&quot;</span>)
</code></pre> <p>原理就是这么简单（但是处理时还是遇到一些问题），为了方便使用，编写了常用的一些插件。</p> <p>至于<code>js-parser</code>就只是在<code>babel-loader</code>前加上了<code>vux-loader</code>的<code>js-loader</code>。</p> <p>而所有的loader, plugins设置都是在<code>vux-loader</code>的<code>merge</code>方法里来完成。</p> <h3>实际使用场景</h3> <p>我们可以使用<code>vux-loader</code>做一些很有意思的事。<br>
比如 <a href="https://github.com/vuejs/vue-loader/issues/542">#542</a> 提到的根据当前feature为判断要输出哪一部分代码，现在已经直接支持，请看 <code>template-feature-switch</code>部分。</p> <p>对于公用组件而言，完全可以实现构建时进行组件瘦身，只保留使用到的代码。</p> <p>当然如果你愿意，你完全可以自己实现一门语言。</p> <h2>安装</h2> <pre class="hljs"><code>npm install vux-loader --save-dev
</code></pre> <h2>使用</h2> <p>为了减少使用成本，只需要调用<code>merge</code>方法对原来<code>webpack</code>配置进行操作：</p> <pre class="hljs"><code><span class="hljs-keyword">const</span> webpackConfig = {} <span class="hljs-comment">// 原来的webpack配置</span>

<span class="hljs-keyword">const</span> vuxLoader = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;vux-loader&#x27;</span>)

<span class="hljs-built_in">module</span>.exports = vuxLoader.merge(webpackConfig, {
  <span class="hljs-attr">options</span>: {},
  <span class="hljs-attr">plugins</span>: [{
    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;vux-ui&#x27;</span>
  }]
})
</code></pre> <p class="warning">
  更新配置后需要重启npm run dev命令
</p> <h3>Options</h3> <ul><li><code>env</code> 非必选，定义当前环境变量，只在vux-loader里使用，用来判断哪些插件需要被执行(如果plugin有定义envs的话)，目的是实现一份配置多个环境使用。</li></ul> <h3>Plugins</h3> <p>插件为一个数组列表，根据需要可以添加你需要的插件，插件名为必须，有些组件不需要额外配置选项。</p> <p>公用参数为:</p> <ul><li><code>name</code> <code>必须</code>，插件名字</li> <li><code>envs</code> <code>非必须</code>，数组，当前插件在哪些环境变量里执行，不定义则默认执行</li></ul> <p>下面的插件配置代码将省略 <code>plugins:[]</code>的书写。</p> <h4>script-parser</h4> <blockquote><p>script代码替换处理</p></blockquote> <pre class="hljs"><code>[{
 <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;script-parser&#x27;</span>,
 <span class="hljs-attr">fn</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">source</span>) </span>{
   <span class="hljs-keyword">return</span> source.replace(<span class="hljs-string">&#x27;VARIABLE&#x27;</span>, <span class="hljs-string">&#x27;v2&#x27;</span>)
 }
}]
</code></pre> <h4>style-parser</h4> <blockquote><p>style代码替换处理</p></blockquote> <pre class="hljs"><code>[{
 <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;style-parser&#x27;</span>,
 <span class="hljs-attr">fn</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">source</span>) </span>{
   <span class="hljs-keyword">return</span> source.replace(<span class="hljs-string">&#x27;black&#x27;</span>, <span class="hljs-string">&#x27;white&#x27;</span>)
 }
}]
</code></pre> <h4>template-parser</h4> <blockquote><p>template代码替换处理</p></blockquote> <blockquote><p>适用于对<code>&lt;template&gt;&lt;/template&gt;</code>模板代码做自定义处理<br>
适用于某些更改不频繁但非服务端配置的文字，可能调用多次，也可能手动更改或者批量替换相对麻烦</p> <p>同样你也可以用来从接口获取最新配置替换特定的占位字符</p> <p>当然也适用于在源码中对<code>pm</code>进行吐槽(千万要记得production环境要有配置，否则可能会上新闻。)</p></blockquote> <ul><li>name 插件名字， <code>template-parser</code></li> <li>replaceList 非必须，正则匹配列表，将直接调用 <code>replace</code> 方法进行替换</li> <li>fn 非必须，相比params更灵活的方法，可以对字符串进行处理后返回</li></ul> <p>插件配置：</p> <pre class="hljs"><code>[
  name: <span class="hljs-string">&quot;template-parser&quot;</span>,
  <span class="hljs-attr">replaceList</span>: [{
    <span class="hljs-attr">test</span>: <span class="hljs-regexp">/DeathToPM/g</span>,
    <span class="hljs-attr">replaceString</span>: <span class="hljs-string">&#x27;微博-随时随地发现新鲜事&#x27;</span>
  }, {
    <span class="hljs-attr">test</span>: <span class="hljs-regexp">/呵呵我们压根没有底线/g</span>,
    <span class="hljs-attr">replaceString</span>: <span class="hljs-string">&#x27;我是有底线的&#x27;</span>
  }],
  <span class="hljs-attr">fn</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">templateSource</span>) </span>{
    <span class="hljs-keyword">return</span> templateSource.replace(<span class="hljs-string">&#x27;智障&#x27;</span>, <span class="hljs-string">&#x27;机智&#x27;</span>)
  }
]
</code></pre> <h4>js-parser</h4> <blockquote><p>项目里js文件处理，在babel-loader前进行处理</p></blockquote> <pre class="hljs"><code>[{
 <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;js-parser&#x27;</span>,
 <span class="hljs-attr">fn</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">source</span>) </span>{
   <span class="hljs-keyword">return</span> source.replace(<span class="hljs-string">&#x27;black&#x27;</span>, <span class="hljs-string">&#x27;white&#x27;</span>)
 }
}]
</code></pre> <h4>template-feature-switch</h4> <p>实现根据变量切换template代码</p> <p>参数：</p> <ul><li><code>features</code>，变量列表，值只能为true或者false</li></ul> <pre class="hljs"><code>{
  <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;template-feature-switch&#x27;</span>,
  <span class="hljs-attr">features</span>: {
    <span class="hljs-attr">feature1</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">feature2</span>: <span class="hljs-literal">false</span>
  }
}
</code></pre> <pre class="hljs"><code><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">on</span> <span class="hljs-attr">feature</span>=<span class="hljs-string">&quot;feature1&quot;</span>&gt;</span>
      AWESOME FEATURE 1 is ON
    <span class="hljs-tag">&lt;/<span class="hljs-name">on</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">off</span> <span class="hljs-attr">feature</span>=<span class="hljs-string">&quot;feature1&quot;</span>&gt;</span>
      AWESOME FEATURE 1 is OFF
    <span class="hljs-tag">&lt;/<span class="hljs-name">off</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
</code></pre> <p>那么当 feature1 为 true时，将输出 <code>AWESOME FEATURE 1 is ON</code>, 反之则输出 <code>AWESOME FEATURE 1 is OFF</code>。注意<code>on</code>标签内不限定内容，可以为任何标签代码块，但<code>避免在on off 里面再嵌套 on off</code></p> <h4>vux-ui</h4> <p class="warning">
  vux组件的配套工具，如果没有使用vux, 不需要添加。
</p> <p>如果配合<code>vux</code>使用，需要手动启用。默认不需要设置选项。</p> <p>该插件做了以下处理：</p> <ul><li>配置<code>babel</code>编译 vux 的js源码</li> <li>修改vue-loader为 <code>vux-loader!vue-loader</code></li> <li><code>import</code>组件调用解析为单组件引入</li></ul> <pre class="hljs"><code>{
  name: &#x27;vux-ui&#x27;
}
</code></pre> <p>那么你就可以很方便地引入组件了：</p> <pre class="hljs"><code>// 0.x
import Group from &#x27;vux/src/components/group&#x27;
import Cell from &#x27;vux/src/components/cell&#x27;

// 2.x
import { Group, Cell } from &#x27;vux&#x27;
</code></pre> <h4>i18n</h4> <ol><li><p>如果你只是调用中文语言的vux组件，那么你不需要做任何配置。</p></li> <li><p>如果你需要调用英文语言的vux组件，需要配置语言</p></li></ol> <pre class="hljs"><code>{
  <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;i18n&#x27;</span>,
  <span class="hljs-attr">vuxStaticReplace</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">vuxLocale</span>: <span class="hljs-string">&#x27;en&#x27;</span>
}
</code></pre> <ol start="3"><li>如果你想和demo站点一样可以写<code>i18n</code>block，并且需要动态切换语言，那么需要配置插件抽取i18n的内容，并设置非静态替换</li></ol> <pre class="hljs"><code>{
  <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;i18n&#x27;</span>,
  <span class="hljs-attr">vuxStaticReplace</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-attr">staticReplace</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-attr">extractToFiles</span>: <span class="hljs-string">&#x27;src/locales/components.yml&#x27;</span>,
  <span class="hljs-attr">localeList</span>: [<span class="hljs-string">&#x27;en&#x27;</span>, <span class="hljs-string">&#x27;zh-CN&#x27;</span>]
}
</code></pre> <p>然后你就可以引用<code>vuex-i18n</code>插件实现多语言切换了。</p> <p>参考 <a href="https://github.com/airyland/vux/blob/v2/src/main.js#L84-L96">main.js</a> 及 <a href="https://www.npmjs.com/package/vuex-i18n">vuex-i18n 文档</a>(仅当参考，你也可以使用其他i18n插件)。</p> <h4>less-theme</h4> <p class="warning">
注意，path所在文件必须是简单的less变量对，不能import其他文件或者引入变量。
</p> <blockquote><p>less 变量设置和替换</p></blockquote> <blockquote><p>适用于全局变量替换,  方便切换主题<br>
这意味着，你不再需要为每个页面引入全局的less文件了，你只需要设置lang为less就可以直接使用变量了</p></blockquote> <pre class="hljs"><code>&lt;style lang=&quot;less&quot;&gt;
.info {
 color: @font-size;
}
&lt;/style&gt;
</code></pre> <p>插件配置：</p> <pre class="hljs"><code>{
  <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;less-theme&#x27;</span>,
  <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;src/styles/theme.less&#x27;</span>
}
</code></pre> <h4>duplicate-style</h4> <blockquote><p>css 重复代码清除</p></blockquote> <p class="tip">
  建议使用vux组件的用户使用，因为vux直接引用less，最终构建的css文件确实会有冗余。
</p> <blockquote><p>在webpack 构建完成后对生成的css文件使用cssnano进行重复样式清除。建议只在production环境下开启，因为dev环境没有必要。</p></blockquote> <pre class="hljs"><code>{
  <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;duplicate-style&#x27;</span>,
  <span class="hljs-attr">events</span>: {
    <span class="hljs-attr">done</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;done!&#x27;</span>)
    }
  }
}
</code></pre> <h4>html-build-callback</h4> <blockquote><p>html文件处理事件回调</p></blockquote> <blockquote><p>适用于在写入html(一般为index.html)文件前进行内容修改，比如替换特定内容<br>
比如写入js配置变量，改变cdn域名，将manifest文件直接写入html以减少请求等</p></blockquote> <pre class="hljs"><code>{
  <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;html-build-callback&#x27;</span>,
  <span class="hljs-attr">events</span>: {
   <span class="hljs-string">&#x27;after-html-processing&#x27;</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">data, cb</span>) </span>{
      data.html += <span class="hljs-string">&#x27;magic footer&#x27;</span>
      cb(<span class="hljs-literal">null</span>, data)
   }
  }
}
</code></pre> <p>可用事件请参考 <a href="https://www.npmjs.com/package/html-webpack-plugin">html-webpack-plugin</a></p> <h4>build-done-callback</h4> <blockquote><p>构建完成事件回调<br>
本质上是在webpack plugin的 done 事件后触发</p></blockquote> <pre class="hljs"><code>{
 <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;build-done-callback&#x27;</span>,
 <span class="hljs-attr">fn</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
   <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;done!&#x27;</span>)
 }
}
</code></pre> <h3>使用案例</h3> <h4>统一引入less(sass)变量</h4> <p>如果你翻看<code>vue-loader</code>的issue, 就会发现不少同学在说，为什么sass, less 变量不能全局使用，需要在每个.vue组件里引入，这个很重复，有没有办法解决。目前除了在webpack里定义路径<code>alias</code>外没有其他方法。但是有了<code>vux-loader</code>，你可以用<code>style-parser</code>在每个<code>.vue</code>文件的style前面加上变量的引入了，只要一句代码。</p> <pre class="hljs"><code>{
  name: &#x27;style-parser&#x27;,
  fn: function (source) {
    return &quot;@import &#x27;../styles/variable.less&#x27;\n&quot; + source // 你可以根据this.resourcePath 来确定是否要引入以及引入的相对路径
  }
}
</code></pre> <h4>减少重复代码</h4> <p><code>vux</code>的组件有几十个，同样demo也有几十个，因为webpack并不支持require变量，那么在main里中实现每个组件异步加载都需要这样：</p> <pre class="hljs"><code><span class="hljs-keyword">const</span> routes = [
  {
    <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;/component/actionsheet&#x27;</span>,
    <span class="hljs-attr">component</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">resolve</span>) </span>{
      <span class="hljs-built_in">require</span>([<span class="hljs-string">&#x27;./demos/Actionsheet&#x27;</span>], resove)
    }
  }
]
</code></pre> <p>作为懒人，写几十次这样的代码是一件比较烦人的事，作为热爱地球的人，这样也很不环保，但是有了<code>vux-loader</code>, 我们可以这样：</p> <pre class="hljs"><code><span class="hljs-keyword">const</span> routes = []
</code></pre> <p>然后在<code>js-parser</code>里获取列表数组直接替换， 并且可以调用webpack的<code>this.addDependency</code>添加依赖实现修改列表时自动<code>reload</code>。从此添加删除组件只要加上或者删除名字就可以了，真是<del>懒</del>机智。</p> <pre class="hljs"><code> {
  <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;js-parser&#x27;</span>,
  <span class="hljs-attr">test</span>: <span class="hljs-regexp">/main\.js/</span>,
  <span class="hljs-attr">fn</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">source</span>) </span>{
    <span class="hljs-keyword">this</span>.addDependency(demoPath)
    <span class="hljs-keyword">let</span> list = fs.readFileSync(demoPath, <span class="hljs-string">&#x27;utf-8&#x27;</span>)
    list = <span class="hljs-built_in">JSON</span>.parse(list)
    <span class="hljs-keyword">let</span> str = []
    list.forEach(<span class="hljs-function"><span class="hljs-params">one</span> =&gt;</span> {
      str.push(<span class="hljs-string">&#x60;{
path: &#x27;/component/<span class="hljs-subst">${toDash(one)}</span>&#x27;,
component: function (resolve) {
require([&#x27;./demos/<span class="hljs-subst">${one}</span>.vue&#x27;], resolve)
}
}&#x60;</span>)
    })

    str = <span class="hljs-string">&#x60;[<span class="hljs-subst">${str.join(<span class="hljs-string">&#x27;,\n&#x27;</span>)}</span>]&#x60;</span>
    source = source.replace(<span class="hljs-string">&#x27;const routes = []&#x27;</span>, <span class="hljs-string">&#x27;const routes = &#x27;</span> + str)
    <span class="hljs-keyword">return</span> source
  }
}
</code></pre> <h4>实现import语法转换</h4> <p>vux是没有main入口文件的，因此需要把import语句转换成单个组件引入。但是因为对语法树分析比较烦，能用正则替换的当然就是用正则替换，简单粗暴实用。具体可以看源码。</p> <h4>开源组件多语言支持</h4> <p>如果以js方式分发，一般默认一个语言，用户可以加上另外的语言包，但是代码里必不可少存在相应的转换函数，对于只需要单语言的人来是个浪费和繁琐。要么所有一起打包，这个也极浪费。要么一个一个打包，这样又失去了动态多语言支持。</p> <p>于是<code>vux</code>在<code>vux-loader</code>的支持下实现了<code>使用时构建</code>，无论是静态输出和动态支持。</p> <h3>Bug 反馈 &amp;&amp; 功能建议</h3> <p>请到<a href="https://github.com/airyland/vux-loader/issues">https://github.com/airyland/vux-loader/issues</a></p> <h3>Todo</h3> <ul class="contains-task-list"><li class="task-list-item"><input disabled="disabled" type="checkbox" class="task-list-item-checkbox"> 支持各个插件的异步返回形式</li> <li class="task-list-item"><input disabled="disabled" type="checkbox" class="task-list-item-checkbox"> 在插件中提供webpack的 this 参数</li></ul></div></div></div></div></div><script>window.__REAM__={"data":{}}</script>
    <script src="/manifest.d8c72eb1.js"></script><script src="/20.44cab544.js"></script><script src="/vendor.08c64339.js"></script><script src="/client.60b9b90f.js"></script>
  </body>
</html>
